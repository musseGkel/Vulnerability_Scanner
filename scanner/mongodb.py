import re
import pymongo

def extract_mongodb_version(version_string):
    # Extract version number from MongoDB version string
    match = re.search(r'([\d.]+)', version_string)
    if match:
        return match.group(1)
    return None

def get_mongodb_version(service):
    # Retrieve MongoDB version from the server info
    try:
        # Connect to MongoDB server
        client = pymongo.MongoClient(host=service['ip'], port=service['port'])
        # Retrieve server info
        server_info = client.server_info()
        # Extract MongoDB version from server info
        mongodb_version = server_info['version']
        return extract_mongodb_version(mongodb_version)
    except pymongo.errors.PyMongoError as e:
        print(f"An error occurred while retrieving MongoDB version: Failed to establish a connection.")
        return None
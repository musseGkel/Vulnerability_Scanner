import json

# Define a function to validate the input data
def validate_service_data(service):
    required_keys = ['ip', 'port', 'base_url', 'service_type']
    for key in required_keys:
        if key not in service:
            raise ValueError(f"Missing required field: {key}")
        if key in ['ip', 'base_url', 'service_type'] and not service[key]:
            raise ValueError(f"Field {key} cannot be empty")
    return True

# Define a function to parse the input JSON file
def parse_input_file(filename):
    try:
        with open(filename, 'r') as file:
            services = json.load(file)
            
            # Validate each service's data
            for service in services:
                validate_service_data(service)
            
            return services
    except FileNotFoundError:
        print(f"The file {filename} was not found.")
    except json.JSONDecodeError:
        print("Invalid JSON format.")
    except ValueError as e:
        print(e)